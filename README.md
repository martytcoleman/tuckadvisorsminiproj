```markdown
# Tuck Advisors Coding Task - Custom GPT Analysis API
By Marty Coleman

This API provides access to and modification of analysis generated by a custom GPT. The API uses Node.js with Express and uses database for data storage persistence. You can use it to get the current GPT output and add new sentences to it as well.

---

## Features

- **Persistent Storage:** Uses a SQLite database (`TuckDatabase.db`) to store the analysis.
- **Endpoints:**  
  - `GET /api/analysis` – Retrieve the current GPT output.
  - `POST /api/analysis` – Add new text to the existing output.
- **Setup:** The database is automatically initialized with data from `data.json` if it’s empty.

---

## Prerequisites
You need to have downloaded
- Node.js
- npm
---

## Installation

1. **Clone or download** the repo
2. Open a terminal (or command prompt) in the project directory.
3. Install the required dependencies by running:
   ```bash
   npm install
   ```
4. Make sure you have a valid `data.json` file in the root directory or you can use mine.
---

## Running the API

To start the API server:
1. In terminal, run:
   ```bash
   node server.js
   ```
2. The server will initialize the database (if needed) and then start listening on **port 3000**. You'll see a message like this:
   ```
   Server running on port 3000
   Connected to SQLite database: TuckDatabase.db
   Initial data inserted successfully.
   ```

---

## API Endpoints

### GET `/api/analysis`

- **Description:** Retrieves the current GPT output from the database.
- **Response Format:**
  ```json
  {
    "gptOutput": "Current analysis text..."
  }
  ```

### POST `/api/analysis`

- **Description:** Appends new text to the current GPT output.  
- **Request Body:**  
  The POST request must have a JSON body with a property named `newSentence`. For example:
  ```json
  {
    "message": "This is a test sentence from my PowerShell script; hello Tuck Advisors team"
  }
  ```
- **Response Format:**
  ```json
  {
    "message": "Content updated with new text: This is a test sentence from my PowerShell script; hello Tuck Advisors team",
    "gptOutput": "Updated analysis text..."
  }
  ```

---

## Testing the API

A PowerShell script (`testAPI.ps1`) is included to test the API on Windows. Here’s how to use it:

1. **Open PowerShell** and navigate to the project directory.
2. **Run the test script:**
   ```powershell
   .\testAPI.ps1
   ```
   The script will:
   - Perform a GET request to retrieve the current GPT output.
   - Perform a POST request to append a new sentence.
   - Perform another GET request to confirm the new text has been persisted.
   
   This is the output it gives me (not including the large amount of text actually printed):
   ```
   Testing GET request (Before POST)...
   { "gptOutput": "Initial GPT output from data.json" }
   --------------------------------------
   Testing POST request...
   { "message": "Content updated with new text: This is a test sentence from PowerShell script.", "gptOutput": "Initial GPT output from data.json This is a test sentence from my PowerShell script; hello Tuck Advisors team." }
   --------------------------------------
   Testing GET request (After POST)...
   { "gptOutput": "Initial GPT output from data.json This is a test sentence from my PowerShell script; hello Tuck Advisors team." }
   --------------------------------------
   Test Completed
   ```
  **Other Way to Test (Browser)**
    - You could open up the API base URL in your browser, then apply the GET and POST one by one via terminal commands using `curl` if on Linux/Mac or `Invoke-RestMethod` commands  as written in my PowerShell testing script for Windows. 
    - the command for macOS/Linux would be `curl -X GET http://localhost:3000/api/analysis` for GET and `curl -X POST -H "Content-Type: application/json" -d '{"newSentence": "This is a test sentence from curl on mac/Linux."}' http://localhost:3000/api/analysis` for POST. Again though, I am using Windows, so haven't tested these commands. 

> **Note:** I'm on Windows, but if you're on macOS / Linux, you can test the API using `curl` or a rest client. The API base URL is:
> ```
> http://localhost:3000/api/analysis
> ```
## Thank You! - Marty